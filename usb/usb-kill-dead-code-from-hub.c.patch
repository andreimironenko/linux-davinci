From oneukum@suse.de Thu Mar  1 13:31:23 2007
From: Oliver Neukum <oneukum@suse.de>
Date: Thu, 1 Mar 2007 22:31:24 +0100
Subject: USB: kill dead code from hub.c
To: gregkh@suse.de, "list, USB" <linux-usb-devel@lists.sourceforge.net>
Message-ID: <200703012231.24288.oneukum@suse.de>
Content-Disposition: inline

this kills residual obsoletet code from hub.c

Signed-off-by: Oliver Neukum <oneukum@suse.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

---
 drivers/usb/core/hub.c |    7 -------
 1 file changed, 7 deletions(-)

--- a/drivers/usb/core/hub.c
+++ b/drivers/usb/core/hub.c
@@ -1281,12 +1281,6 @@ int usb_new_device(struct usb_device *ud
 {
 	int err;
 
-	/* Lock ourself into memory in order to keep a probe sequence
-	 * sleeping in a new thread from allowing us to be unloaded.
-	 */
-	if (!try_module_get(THIS_MODULE))
-		return -EINVAL;
-
 	/* Determine quirks */
 	usb_detect_quirks(udev);
 
@@ -1390,7 +1384,6 @@ int usb_new_device(struct usb_device *ud
 		usb_autoresume_device(udev->parent);
 
 exit:
-	module_put(THIS_MODULE);
 	return err;
 
 fail:
