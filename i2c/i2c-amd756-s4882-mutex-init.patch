From khali@linux-fr.org Mon Feb 27 14:08:27 2006
Date: Mon, 27 Feb 2006 23:09:22 +0100
From: Jean Delvare <khali@linux-fr.org>
To: Greg KH <greg@kroah.com>
Subject: I2C: i2c-amd756-s4882: Improve static mutex initialization
Message-Id: <20060227230922.e540201d.khali@linux-fr.org>
Content-Disposition: inline; filename=i2c-amd756-s4882-mutex-init.patch

Static mutexes can be initialized at declaration time.

Signed-off-by: Jean Delvare <khali@linux-fr.org>
---
 drivers/i2c/busses/i2c-amd756-s4882.c |    4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

--- gregkh-2.6.orig/drivers/i2c/busses/i2c-amd756-s4882.c
+++ gregkh-2.6/drivers/i2c/busses/i2c-amd756-s4882.c
@@ -46,7 +46,7 @@ static struct i2c_adapter *s4882_adapter
 static struct i2c_algorithm *s4882_algo;
 
 /* Wrapper access functions for multiplexed SMBus */
-static struct mutex amd756_lock;
+static DEFINE_MUTEX(amd756_lock);
 
 static s32 amd756_access_virt0(struct i2c_adapter * adap, u16 addr,
 			       unsigned short flags, char read_write,
@@ -167,8 +167,6 @@ static int __init amd756_s4882_init(void
 	}
 
 	printk(KERN_INFO "Enabling SMBus multiplexing for Tyan S4882\n");
-	mutex_init(&amd756_lock);
-
 	/* Define the 5 virtual adapters and algorithms structures */
 	if (!(s4882_adapter = kzalloc(5 * sizeof(struct i2c_adapter),
 				      GFP_KERNEL))) {
